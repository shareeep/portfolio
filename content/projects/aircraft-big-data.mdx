---
title: "Aircraft Delay Propagation with AWS Big Data"
description: "Using AWS S3, Glue, Athena, and EMR to analyse how individual aircraft propagate delays across the U.S. network, with a focus on tail-level risk scoring and operational levers like turnaround time and utilisation."
image: /images/projects/aircraft-bda.png
date: "2025-11-10"
authors:
  - shariff-rashid
tags: ["Big Data", "Data Engineering", "Data Analysis", "Apache Spark", "AWS", "AWS Glue", "AWS Athena", "AWS EMR", "PySpark"]
---

## Overview

Flight delays are rarely isolated events. A single late arrival can ripple through the network, causing cascading disruptions that affect flights across the country. This project explores how individual aircraft contribute to this network-wide delay propagation across the U.S. air transport system.

By combining **airline on-time performance** data with **FAA aircraft registration data**, we sought to understand how tail-level behaviour, schedules, and operational patterns combine to create these cascading delays. The goal was to move beyond simple delay statistics and identify the specific "network multipliers"—aircraft that consistently amplify delays—and build a scalable analytics pipeline on AWS to predict them.

---

## The Challenge

> Which aircraft act as “network multipliers” for delays, and what can operations teams *actually do* about them?

The core of this analysis revolves around identifying persistent patterns of delay propagation. We wanted to answer a critical operational question: **Which aircraft consistently turn a late arrival into a cascading series of departure delays?**

To answer this, we needed to:

- Identify **problematic aircraft** that repeatedly propagate delays (the “network multiplier” effect).
- Quantify **operational risk factors** like turnaround time, fleet utilisation, and time of day.
- Build **tail-level risk scores and clusters** so ops teams can prioritise interventions on a small set of high-impact aircraft.

While we also looked at predicting airport congestion windows across major U.S. hubs (like ATL, ORD, JFK), the primary focus of this post is on the aircraft-level analysis and the AWS architecture that enabled it.  

---

## Data & Sources

### Flight Operations

- **Airline On-Time Performance** dataset (2007–2008), containing detailed flight-level timestamps, carrier codes, delays, origins/destinations and tail numbers.
- Flights are grouped by **tail number** to reconstruct aircraft-level itineraries and chains of consecutive legs.

### FAA Aircraft Registry

To understand aircraft characteristics, we ingested the FAA’s releasable aircraft registry:

- **MASTER**: registration records keyed by tail number (N-number).
- **ACFTREF**: reference table mapping make/model/series codes to human-readable aircraft types.

These were joined to attach **age, manufacturer, and model** to each tail number for downstream analytics like “Does aircraft age drive cascading?” and “Which models cascade chronically?”.

---

## Architecture & AWS Stack

The solution architecture leaned heavily on **AWS managed services**, evolving from simple ETL scripts to a robust EMR-centric analytics pipeline:

- **Amazon S3** served as the central data lake for raw CSVs, FAA registry files, and partitioned Parquet tables of enriched flight chains.
- **AWS Glue** was used for initial data cataloguing and partitioning, particularly for merging flight data with weather conditions.
- **AWS EMR** handled the heavy transformation and analytics workloads. We used EMR to gain control over cluster sizing and runtime, optimising costs by scaling clusters only when needed.
- **EMR Studio + Notebooks** provided our main workbench for PySpark development, allowing for easy debugging and quick iteration on UDFs and metrics.
- **MLlib** on EMR was used for training Gradient Boosted Trees and Multilayer Perceptron classifiers.

---

## Modelling Delay Propagation

### 1. Data Transformation on EMR

Most of the heavy lifting happened in PySpark notebooks on EMR.

**Timestamp Normalisation**

- Input fields were raw `HHMM` strings, sometimes with decimals, missing values, or overnight flights.
- We standardised them by:
  - Cleaning and left-padding (`"930"` → `"0930"`, `"1141.0"` → `"1141"`).
  - Treating `"0000"` and empty strings as missing.
  - Detecting overnight legs (e.g. depart 23:00, arrive 01:30 next day) and shifting the arrival date by +1 day.

**Data Quality Pipeline**

- Filled missing delay fields, deduplicated rows, and removed only **obvious outliers**, preserving ~99% of rows for analysis.

**Chain Detection**

- Flights are grouped by tail number and sorted by departure time.
- A **6-hour gap threshold** is applied:
  - If the gap between an arrival and the next departure exceeds 6 hours, a new chain (operational “shift”) begins.
  - Rationale: aligns with FAA duty regulations; 4 hours was too strict, 8 hours too loose.

This produced stable **flight chains** that reflect realistic aircraft and crew shifts rather than arbitrary daily cuts.

**Propagation Metrics**

For each leg in a chain we computed:

- `prop_depth`: length of consecutive downstream delays, respecting turnarounds.
- `flights_to_recovery`: number of legs until the chain returns to “on-time” behaviour.
- `delay_amplification`: how much delay grows (or shrinks) across successive legs.

The resulting table, `chains_with_metrics`, was written to partitioned Parquet in S3 for fast reuse in analytics and modelling.

### 2. Joining FAA Enrichment

A second set of notebooks joined **FAA aircraft metadata** to the subset of “cascader” aircraft (those with significant propagation metrics):

- Normalised tail numbers and applied **two-phase matching** to reconcile operational N-numbers with FAA records.
- Used **ACFTREF** codes to decode into model families (e.g. 737, A320, EMB regional jets).

The output `faa_enriched_cascaders` feeds aircraft-age and model-level analysis.

### 3. Predictive Modelling

We framed a two-stage modelling task using Spark MLlib on EMR:

1. **Stage 1 (binary)** – *Will this flight cascade?*
   - Label: whether downstream legs show propagation beyond a threshold.
2. **Stage 2 (multi-class)** – *If it cascades, how many legs? (1, 2, 3+)*

Models:

- Gradient Boosted Trees classifier (GBT).
- Multilayer Perceptron classifier, leveraging the chain-level engineered features.  

---

## Key Findings

### 1. Problematic Aircraft & Risk Tiers

We aggregated propagation metrics by tail number, computed composite **risk scores**, and segmented tails into quadrants:

- Thresholds: propagation depth ≥ 1.0 and propagation rate ≥ 25% to flag severe, frequent cascaders.
- Most aircraft are **low-risk** (≈86.4%), while only ~0.4% fall into a “critical” category—but those few have disproportionate network impact.  

This supports a **focused intervention strategy**: schedule buffers, maintenance checks, or special handling for a small set of high-risk tails.

### 2. Turnaround Time as an Operational Lever

We bucketed planned turnarounds and analysed propagation metrics by bucket:

- Longer planned turnarounds → **more variable but less harmful** in terms of cascading:
  - Average propagation depth trends toward ~0, as chains have time to recover.
  - Cascade rate decreases and absorption increases.  

Operationally: giving tight turnarounds to already risky aircraft is a bad idea; allocating extra buffer to them is a simple, high-leverage fix.

### 3. Fleet Utilisation

By grouping aircraft by utilisation band:

- Lower-utilisation aircraft show **significantly lower propagation depth**.
- Propagation and absorption *rates* don’t move much with utilisation, but the **length of cascades** does.  

So high utilisation itself isn’t always bad—but when aircraft are both highly utilised *and* delay-prone, cascades become longer and harder to recover from.

### 4. Time of Day: When Delays Compound

Time-of-day analysis shows:

- During the day (especially bank periods), average propagation depth increases: more flights, longer chains, and more opportunities for delay to spread.
- At night, **average absorption increases** as lighter schedules provide natural slack for recovery.

This suggests that morning and late-afternoon waves deserve stricter control on tight connections and high-risk tails.

### 5. Best vs Worst Carriers

Even with the same infrastructure:

- **Best performers** (e.g. Hawaiian Airlines, Aloha) exhibit low propagation and high absorption rates.
- **Worst performers** (e.g. ExpressJet) show the opposite pattern.

This highlights that **operational practices** (crew planning, maintenance, schedule design) matter as much as physical constraints.

### 6. Aircraft Age & Model (FAA Enriched Analytics)

Using the FAA-enriched dataset:

- **Age**: Propagation depth, rate and absorption are broadly similar across age buckets—delays seem driven more by operations than by aircraft age alone.
- **Model**: No clear “smoking gun” model family in terms of risk score or propagation rate; there is some variance in depth, but sample sizes (e.g. certain 757 configs) limit how strong a conclusion we can draw.  

---

## Conclusion

This project demonstrated how a carefully designed **big-data pipeline on AWS** can move from raw CSVs to actionable tail-level risk scores.

From an engineering perspective, the **AWS-first architecture** (S3, Glue, EMR, Athena, MLlib) made it feasible to work with multi-gigabyte datasets, chain-level computations, and iterative modelling without over-provisioning resources. Transitioning to EMR notebooks gave us better cost control and faster iteration loops.

From a business perspective, the key takeaway is that a small fraction of aircraft behave as **network multipliers**. Targeting them with tailored buffers or schedule changes can yield outsized gains. We also found that **turnaround time and time of day** are controllable levers that meaningfully change propagation dynamics, and that **operations** (scheduling, utilisation, maintenance) explain more of the cascades than hardware alone.
